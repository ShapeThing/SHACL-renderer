@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix schema: <https://schema.org/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dash: <http://datashapes.org/dash#> .
@prefix stsr: <http://ontology.shapething.com/shacl-renderer#> .
@prefix stf: <http://ontology.shapething.com/facet#> .
@prefix dbc: <http://dbpedia.org/resource/Category:> .
@prefix wdt: <http://www.wikidata.org/prop/direct/> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix faker: <https://fakerjs.dev/> .
@prefix app: <http://localhost:6006/> .

<>
  a sh:NodeShape ;
  sh:targetClass sh:NodeShape ;
  sh:closed true ;

  sh:property [
    sh:name "Name"@en, "Naam"@nl ;
    sh:minCount 1;
    sh:order 1;
		sh:uniqueLang true ;
    # sh:group <#name> ;
    sh:description "De gebruiksvriendelijke naam"@nl, "A user friendly name"@en ;
    sh:path sh:name ;
    sh:datatype rdf:langString ;
  ];

  sh:property [
    sh:name "Target"@en, "Doel"@nl ;
    sh:minCount 1;
    sh:maxCount 1;
    sh:description "Het type van de resource"@nl, "The type of resource"@en ;
    sh:order 2 ;
    # sh:group <#name> ;
    sh:path sh:targetClass ;
    sh:nodeKind sh:IRI ;
    dash:editor dash:URIEditor ;
  ];

  sh:property [
    sh:name "Closed"@en, "Gesloten"@nl ;
    sh:description "Wanneer de vorm gesloten is, worden onbekende eigenschappen niet toegelaten."@nl, "When the shape is closed, it does not allow unknown properties."@en ;
    sh:maxCount 1;
    sh:datatype xsd:boolean ;
    sh:order 5;
    # sh:group <#booleans>;
    sh:path sh:closed ;
  ];

  sh:property [
    sh:name "Abstract"@en, "Abstract"@nl ;
    sh:maxCount 1;
    sh:datatype xsd:boolean ;
    sh:order 6;
    sh:description "An abstract shape is often a sub shape, something you do not want to list or create a stand alone version for."@en, "Een abstracte vorm is vaak een subvorm. U wilt deze vorm niet opsommen en er geen aparte versie van maken."@nl ;
    # sh:group <#booleans>;
    sh:path dash:abstract ;
  ];

  # sh:property [
  #   sh:name "Ignored properties"@en, "Genegeerde eigenschappen"@nl ;
  #   sh:group <#booleans>;
  #   sh:path sh:ignoredProperties ;
  # ];

  sh:property [
    sh:name "Stem"@en, "Stam"@nl ;
    sh:minCount 1;
    sh:maxCount 1;
    sh:order 3;
    sh:description "Het gedeelte na het domein wordt gebruikt voor het maken van de mappenstructuur."@nl, "The section after the domain is used for creating the folder structure."@en ;
    # sh:group <#stem-icon> ;
    sh:path dash:stem ;
    dash:editor dash:URIEditor ;
  ];

  sh:property [
    sh:name "Icon"@en, "Icoon"@nl ;
    sh:minCount 1;
    sh:maxCount 1;
    sh:order 4;
    # sh:group <#stem-icon> ;
    sh:path stsr:icon ;
    sh:datatype <https://iconify.design> ;
  ];

  sh:property [
    sh:name "Properties"@en, "Eigenschappen"@nl ;
    sh:minCount 1;
    sh:path sh:property ;
    stsr:nestedOrder sh:order ;
    sh:nodeKind sh:BlankNode ;
    sh:description "Dit zijn de eigenschappen van het type. De velden in het formulier. Je kunt de volgorde aanpassen door te slepen."@nl, "These are the properties of the type. The fields in the form. You can change the order by dragging."@en ;
    sh:node <#propertyShape>;
  ];

  sh:property [
    sh:name "Name pattern"@en, "Naam patroon"@nl ;
    sh:minCount 1;
    sh:path ( stsr:filenameSuggestion [ sh:zeroOrMorePath rdf:rest ] rdf:first ) ;
    sh:description "De naam van het bestand wordt gegenereerd uit de volgende waarden."@nl, "The file name is generated from the following values."@en ;

		sh:or (
			[
				sh:datatype xsd:string ;
        dash:editor dash:TextFieldEditor ;
        sh:nodeKind sh:Literal ;
			]
			[
        sh:nodeKind sh:IRI ;
        dash:editor dash:EnumSelectEditor ;
        sh:in [
          sh:select """
            prefix sh: <http://www.w3.org/ns/shacl#>

            SELECT distinct ?value ?label
            WHERE {
              ?property ^sh:property ?node .
              ?property sh:path ?value .
              ?property sh:name ?label .
            }
            """ ;
        ] ;
			]
		) ;
  ];

.

<#booleans>
	a sh:PropertyGroup ;
	sh:order 5 .

<#stem-icon>
	a sh:PropertyGroup ;
	sh:order 2 .

<#name>
	a sh:PropertyGroup ;
	sh:order 1 .

<#propertyName>
	a sh:PropertyGroup ;
  sh:group <#propertyShapeGroup> ;
	sh:order 1 .

<#cardinality>
	a sh:PropertyGroup ;
  sh:group <#propertyShapeGroup> ;
	sh:order 9 .

<#misc>
	a sh:PropertyGroup ;
  sh:group <#propertyShapeGroup> ;
	sh:order 4 .

<#details>
	a sh:PropertyGroup ;
  sh:group <#propertyShapeGroup> ;
	sh:order 3 .

<#propertyShapeGroup>
	a sh:PropertyGroup, stsr:CollapsiblePropertyGroup;
  stsr:groupLabelPath ( "Eigenschap: "@nl "Property: "@en sh:name ) ;
	sh:order 1 .

<#propertyShape>
  sh:closed true ;
  a sh:NodeShape ;
  dash:abstract true ;

  sh:ignoredProperties ( faker:generator sh:in ) ;

  sh:property [
    sh:name "Name"@en, "Naam"@nl ;
    sh:minCount 1;
    sh:order 1;
		sh:uniqueLang true ;
    sh:group <#propertyShapeGroup> ;
    sh:path sh:name ;
    sh:description "De naam van deze eigenschap zoals deze getoond wordt in het formulier."@nl, "The name of this property as it will appear in the form."@en ;
    sh:datatype rdf:langString ;
  ];

  # sh:property [
  #   sh:name "Ignored properties"@en, "Genegeerde eigenschappen"@nl ;
  #   sh:path sh:ignoredProperties ;
  #   sh:group <#misc> ;
  # ];

  sh:property [
    sh:name "Order"@en, "Gewicht"@nl ;
    sh:maxCount 1;
    sh:order 8;
    sh:description "Het gewicht van de eigenschap, grotere waarden wegen meer en worden dus lager getoond."@nl, "The order of the property, bigger values weigh more and will be shown lower."@en ;
    sh:group <#propertyShapeGroup> ;
    sh:datatype xsd:decimal ;
    sh:path sh:order ;
  ];

  # sh:property [
  #   sh:name "Closed"@en, "Gesloten"@nl ;
  #   sh:maxCount 1;
  #   sh:order 4;
  #   sh:group <#propertyShapeGroup> ;
  #   sh:datatype xsd:boolean ;
  #   sh:path sh:closed ;
  # ];

  sh:property [
    sh:name "Description"@en, "Omschrijving"@nl ;
    dash:singleLine false ;
		sh:uniqueLang true ;
    sh:description "De beschrijving van deze eigenschap, wordt getoond in het formulier."@nl, "The description of this property is shown in the form."@en ;
    sh:order 10;
    sh:group <#propertyShapeGroup> ;
    sh:path sh:description ;
    sh:datatype rdf:langString ;
  ];

  sh:property [
    sh:name "Path"@en, "Pad"@nl ;
    sh:minCount 1;
    sh:description "Het predicaat voor deze eigenschap."@nl, "The predicate for this property."@en ;
    sh:group <#propertyShapeGroup> ;
    sh:maxCount 1;
    sh:order 2;
    dash:editor dash:URIEditor ;
    sh:path sh:path ;
    sh:nodeKind sh:IRI ;
  ];
  
  sh:property [
    sh:name "Minimum count"@en, "Minimaal aantal"@nl ;
    sh:group <#cardinality> ;
    sh:maxCount 1;
    sh:description "Gebruik tenminste 1 wanneer deze eigenschap verplicht is."@nl, "Use at least 1 when this property is required."@en ;
    sh:order 1;
    sh:path sh:minCount ;
    sh:datatype xsd:integer ;
  ];
    
  sh:property [
    sh:name "Maximum count"@en, "Maximaal aantal"@nl ;
    sh:maxCount 1;
    sh:order 2;
    sh:group <#cardinality> ;
    sh:description "Mag iemand meerdere waarden invullen?"@nl, "Is it allowed to have multiple values?"@en ;
    sh:path sh:maxCount ;
    sh:datatype xsd:integer ;
  ];

  sh:property [
    sh:name "Group"@en, "Groep"@nl ;
    sh:description "Wil je deze eigenschap in een groep tonen?"@nl, "Do you want to show this property in a group?"@en ;
    sh:group <#propertyShapeGroup> ;
    sh:maxCount 1;
    sh:order 6;
    sh:path sh:group ;
    sh:in [
      sh:select """
        prefix sh: <http://www.w3.org/ns/shacl#>

        SELECT distinct ?value ?label
        WHERE {
          ?value a sh:PropertyGroup .
          optional {
            ?value sh:name ?name .
          }
          bind(coalesce(?name, strafter(str(?value), "#"), strafter(str(?value), "/")) as ?label)
        }
        """ ;
    ] ;
  ];

  sh:property [
    sh:name "Data type"@en, "Data type"@nl ;
    sh:group <#propertyShapeGroup> ;
    sh:maxCount 1;
    sh:description "Het datatype van deze eigenschap. Dit is handig voor overzicht en data kwaliteit."@nl, "The data type of this property. This is helpful for overviews and data quality."@en ;
    sh:order 5;
    sh:path sh:datatype ;
    sh:in (
      xsd:string xsd:float rdf:langString
    ) ;
  ];
.

xsd:string rdfs:label "Text"@en, "Tekst"@nl .
xsd:integer rdfs:label "Integer"@en, "Nummer"@nl .
xsd:decimal rdfs:label "Decimal"@en, "Decimaal"@nl .
rdf:langString rdfs:label "Multilingual text"@en, "Meertalige tekst"@nl .